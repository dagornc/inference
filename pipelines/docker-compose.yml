version: '3.8'

services:
  pipelines:
    image: ghcr.io/open-webui/pipelines:main
    container_name: pipelines
    ports:
      - "9099:9099"
    volumes:
      - .:/app/pipelines
      - ../src:/app/pipelines/src
      - ../config:/app/pipelines/config
      # Mount data if needed, e.g. for local embeddings cache or similar
      - ../data:/app/pipelines/data
    environment:
      - PIPELINES_URLS=http://0.0.0.0:9099
      # ChromaDB Connection
      - CHROMA_HOST=host.docker.internal
      - CHROMA_PORT=8000
      # OpenAI/LLM Keys (passed from host or .env)
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: always
